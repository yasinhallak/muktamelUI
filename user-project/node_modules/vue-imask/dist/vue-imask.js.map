{"version":3,"file":"vue-imask.js","sources":["../src/component.js","../src/directive.js"],"sourcesContent":["import IMask from 'imask/esm/imask';\r\n\r\n\r\nconst IMaskComponent = {\r\n  name: 'imask-input',\r\n\r\n  render (createElement) {\r\n    const props = {\r\n      domProps: {\r\n        value: this.maskRef ? this.maskRef.value : this.value\r\n      },\r\n      on: {...this.$listeners},\r\n    };\r\n\r\n    // if there is no mask use default input event\r\n    if (!this.$props.mask) {\r\n      props.on.input = event => this.$emit('input', event.target.value);\r\n    } else {\r\n      delete props.on.input;\r\n    }\r\n\r\n    return createElement('input', props);\r\n  },\r\n\r\n  mounted () {\r\n    if (!this.$props.mask) return;\r\n\r\n    this._initMask();\r\n  },\r\n\r\n  destroyed () {\r\n    this._destroyMask();\r\n  },\r\n\r\n  computed: {\r\n    maskOptions () {\r\n      return this._extractOptionsFromProps(this.$props);\r\n    },\r\n  },\r\n\r\n  watch: {\r\n    '$props': {\r\n      handler (props) {\r\n        const maskOptions = this.maskOptions;\r\n        if (maskOptions.mask) {\r\n          if (this.maskRef) {\r\n            this.maskRef.updateOptions(maskOptions);\r\n            if ('value' in props &&\r\n              (props.value !== this._maskValue() ||\r\n                // handle cases like Number('') === 0,\r\n                // for details see https://github.com/uNmAnNeR/imaskjs/issues/134\r\n                (typeof props.value !== 'string' && this.maskRef.value === '') &&\r\n                  !this.maskRef.el.isActive)\r\n            ) {\r\n              this._updateValue();\r\n            }\r\n          } else {\r\n            this._initMask(maskOptions);\r\n            if (props.value !== this._maskValue()) this._onAccept();\r\n          }\r\n        } else {\r\n          this._destroyMask();\r\n          if ('value' in props) this.$el.value = props.value;\r\n        }\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    _extractOptionsFromProps (props) {\r\n      props = {...props};\r\n\r\n      // keep only defined props\r\n      Object.keys(props)\r\n        .filter(prop => props[prop] === undefined)\r\n        .forEach(undefinedProp => {\r\n          delete props[undefinedProp];\r\n        });\r\n\r\n      delete props.value;\r\n      delete props.unmask;\r\n\r\n      return props;\r\n    },\r\n\r\n    _maskValue () {\r\n      if (this.unmask === 'typed') return this.maskRef.typedValue;\r\n      if (this.unmask) return this.maskRef.unmaskedValue;\r\n      return this.maskRef.value;\r\n    },\r\n\r\n    _updateValue () {\r\n      const value = this.value == null ? '' : this.value;\r\n      if (this.unmask === 'typed') this.maskRef.typedValue = value;\r\n      else if (this.unmask) this.maskRef.unmaskedValue = value;\r\n      else this.maskRef.value = value;\r\n    },\r\n\r\n    _onAccept () {\r\n      const val = this._maskValue();\r\n      this.$emit('input', val);\r\n      this.$emit('accept', val);\r\n    },\r\n\r\n    _onComplete () {\r\n      this.$emit('complete', this._maskValue());\r\n    },\r\n\r\n    _initMask (maskOptions=this.maskOptions) {\r\n      this.maskRef = IMask(this.$el, maskOptions)\r\n        .on('accept', this._onAccept.bind(this))\r\n        .on('complete', this._onComplete.bind(this));\r\n      this._updateValue();\r\n    },\r\n\r\n    _destroyMask () {\r\n      if (this.maskRef) {\r\n        this.maskRef.destroy();\r\n        delete this.maskRef;\r\n      }\r\n    }\r\n  },\r\n\r\n  props: {\r\n    // common\r\n    mask: {},\r\n    value: {},\r\n    unmask: {\r\n      validator: function (value) {\r\n        return value === 'typed' || typeof value === 'boolean';\r\n      }\r\n    },\r\n    prepare: Function,\r\n    validate: Function,\r\n    commit: Function,\r\n    overwrite: {\r\n      type: Boolean,\r\n      required: false,\r\n      default: undefined,\r\n    },\r\n\r\n    // pattern\r\n    placeholderChar: String,\r\n    lazy: {\r\n      type: Boolean,\r\n      required: false,\r\n      default: undefined,\r\n    },\r\n    definitions: Object,\r\n    blocks: Object,\r\n\r\n    // date\r\n    pattern: String,\r\n    format: Function,\r\n    parse: Function,\r\n    autofix: {\r\n      type: Boolean,\r\n      required: false,\r\n      default: undefined,\r\n    },\r\n\r\n    // number\r\n    radix: String,\r\n    thousandsSeparator: String,\r\n    mapToRadix: Array,\r\n    scale: Number,\r\n    signed: {\r\n      type: Boolean,\r\n      required: false,\r\n      default: undefined,\r\n    },\r\n    normalizeZeros: {\r\n      type: Boolean,\r\n      required: false,\r\n      default: undefined,\r\n    },\r\n    padFractionalZeros: {\r\n      type: Boolean,\r\n      required: false,\r\n      default: undefined,\r\n    },\r\n    min: [Number, Date],\r\n    max: [Number, Date],\r\n\r\n    // dynamic\r\n    dispatch: Function\r\n  },\r\n}\r\n\r\n\r\nexport default IMaskComponent;\r\n","import IMask from 'imask/esm/imask';\r\n\r\n\r\nconst IMaskDirective = {\r\n  name: 'imask',\r\n\r\n  bind (el, {value: options}) {\r\n    if (!options) return;\r\n\r\n    initMask(el, options);\r\n  },\r\n\r\n  update (el, {value: options}) {\r\n    if (options) {\r\n      if (el.maskRef) {\r\n        el.maskRef.updateOptions(options);\r\n        if (el.value !== el.maskRef.value) el.maskRef._onChange();\r\n      }\r\n      else initMask(el, options);\r\n    } else {\r\n      destroyMask(el);\r\n    }\r\n  },\r\n\r\n  unbind (el) {\r\n    destroyMask(el);\r\n  }\r\n};\r\n\r\nfunction fireEvent (el, eventName, data) {\r\n  var e = document.createEvent('CustomEvent');\r\n  e.initCustomEvent(eventName, true, true, data);\r\n  el.dispatchEvent(e);\r\n}\r\n\r\nfunction initMask (el, opts) {\r\n  el.maskRef = IMask(el, opts)\r\n    .on('accept', () => fireEvent(el, 'accept', el.maskRef))\r\n    .on('complete', () => fireEvent(el, 'complete', el.maskRef));\r\n}\r\n\r\nfunction destroyMask (el) {\r\n  if (el.maskRef) {\r\n    el.maskRef.destroy();\r\n    delete el.maskRef;\r\n  }\r\n}\r\n\r\n\r\nexport default IMaskDirective;\r\n"],"names":["IMaskComponent","name","render","createElement","props","domProps","value","maskRef","on","$listeners","$props","mask","input","event","$emit","target","mounted","_initMask","destroyed","_destroyMask","computed","maskOptions","_extractOptionsFromProps","watch","handler","updateOptions","_maskValue","el","isActive","_updateValue","_onAccept","$el","deep","methods","Object","keys","filter","prop","undefined","forEach","undefinedProp","unmask","typedValue","unmaskedValue","val","_onComplete","IMask","bind","destroy","validator","prepare","Function","validate","commit","overwrite","type","Boolean","required","default","placeholderChar","String","lazy","definitions","blocks","pattern","format","parse","autofix","radix","thousandsSeparator","mapToRadix","Array","scale","Number","signed","normalizeZeros","padFractionalZeros","min","Date","max","dispatch","IMaskDirective","options","initMask","update","_onChange","destroyMask","unbind","fireEvent","eventName","data","e","document","createEvent","initCustomEvent","dispatchEvent","opts"],"mappings":";;;;;;;;EAGA,IAAMA,cAAc,GAAG;EACrBC,EAAAA,IAAI,EAAE,aADe;EAGrBC,EAAAA,MAHqB,kBAGbC,aAHa,EAGE;EAAA;;EACrB,QAAMC,KAAK,GAAG;EACZC,MAAAA,QAAQ,EAAE;EACRC,QAAAA,KAAK,EAAE,KAAKC,OAAL,GAAe,KAAKA,OAAL,CAAaD,KAA5B,GAAoC,KAAKA;EADxC,OADE;EAIZE,MAAAA,EAAE,oBAAM,KAAKC,UAAX;EAJU,KAAd,CADqB;;EASrB,QAAI,CAAC,KAAKC,MAAL,CAAYC,IAAjB,EAAuB;EACrBP,MAAAA,KAAK,CAACI,EAAN,CAASI,KAAT,GAAiB,UAAAC,KAAK;EAAA,eAAI,KAAI,CAACC,KAAL,CAAW,OAAX,EAAoBD,KAAK,CAACE,MAAN,CAAaT,KAAjC,CAAJ;EAAA,OAAtB;EACD,KAFD,MAEO;EACL,aAAOF,KAAK,CAACI,EAAN,CAASI,KAAhB;EACD;;EAED,WAAOT,aAAa,CAAC,OAAD,EAAUC,KAAV,CAApB;EACD,GAnBoB;EAqBrBY,EAAAA,OArBqB,qBAqBV;EACT,QAAI,CAAC,KAAKN,MAAL,CAAYC,IAAjB,EAAuB;;EAEvB,SAAKM,SAAL;EACD,GAzBoB;EA2BrBC,EAAAA,SA3BqB,uBA2BR;EACX,SAAKC,YAAL;EACD,GA7BoB;EA+BrBC,EAAAA,QAAQ,EAAE;EACRC,IAAAA,WADQ,yBACO;EACb,aAAO,KAAKC,wBAAL,CAA8B,KAAKZ,MAAnC,CAAP;EACD;EAHO,GA/BW;EAqCrBa,EAAAA,KAAK,EAAE;EACL,cAAU;EACRC,MAAAA,OADQ,mBACCpB,KADD,EACQ;EACd,YAAMiB,WAAW,GAAG,KAAKA,WAAzB;;EACA,YAAIA,WAAW,CAACV,IAAhB,EAAsB;EACpB,cAAI,KAAKJ,OAAT,EAAkB;EAChB,iBAAKA,OAAL,CAAakB,aAAb,CAA2BJ,WAA3B;;EACA,gBAAI,WAAWjB,KAAX,KACDA,KAAK,CAACE,KAAN,KAAgB,KAAKoB,UAAL,EAAhB;EAEC;EACC,mBAAOtB,KAAK,CAACE,KAAb,KAAuB,QAAvB,IAAmC,KAAKC,OAAL,CAAaD,KAAb,KAAuB,EAA3D,IACE,CAAC,KAAKC,OAAL,CAAaoB,EAAb,CAAgBC,QALnB,CAAJ,EAME;EACA,mBAAKC,YAAL;EACD;EACF,WAXD,MAWO;EACL,iBAAKZ,SAAL,CAAeI,WAAf;;EACA,gBAAIjB,KAAK,CAACE,KAAN,KAAgB,KAAKoB,UAAL,EAApB,EAAuC,KAAKI,SAAL;EACxC;EACF,SAhBD,MAgBO;EACL,eAAKX,YAAL;;EACA,cAAI,WAAWf,KAAf,EAAsB,KAAK2B,GAAL,CAASzB,KAAT,GAAiBF,KAAK,CAACE,KAAvB;EACvB;EACF,OAvBO;EAwBR0B,MAAAA,IAAI,EAAE;EAxBE;EADL,GArCc;EAkErBC,EAAAA,OAAO,EAAE;EACPX,IAAAA,wBADO,oCACmBlB,KADnB,EAC0B;EAC/BA,MAAAA,KAAK,qBAAOA,KAAP,CAAL,CAD+B;;EAI/B8B,MAAAA,MAAM,CAACC,IAAP,CAAY/B,KAAZ,EACGgC,MADH,CACU,UAAAC,IAAI;EAAA,eAAIjC,KAAK,CAACiC,IAAD,CAAL,KAAgBC,SAApB;EAAA,OADd,EAEGC,OAFH,CAEW,UAAAC,aAAa,EAAI;EACxB,eAAOpC,KAAK,CAACoC,aAAD,CAAZ;EACD,OAJH;EAMA,aAAOpC,KAAK,CAACE,KAAb;EACA,aAAOF,KAAK,CAACqC,MAAb;EAEA,aAAOrC,KAAP;EACD,KAfM;EAiBPsB,IAAAA,UAjBO,wBAiBO;EACZ,UAAI,KAAKe,MAAL,KAAgB,OAApB,EAA6B,OAAO,KAAKlC,OAAL,CAAamC,UAApB;EAC7B,UAAI,KAAKD,MAAT,EAAiB,OAAO,KAAKlC,OAAL,CAAaoC,aAApB;EACjB,aAAO,KAAKpC,OAAL,CAAaD,KAApB;EACD,KArBM;EAuBPuB,IAAAA,YAvBO,0BAuBS;EACd,UAAMvB,KAAK,GAAG,KAAKA,KAAL,IAAc,IAAd,GAAqB,EAArB,GAA0B,KAAKA,KAA7C;EACA,UAAI,KAAKmC,MAAL,KAAgB,OAApB,EAA6B,KAAKlC,OAAL,CAAamC,UAAb,GAA0BpC,KAA1B,CAA7B,KACK,IAAI,KAAKmC,MAAT,EAAiB,KAAKlC,OAAL,CAAaoC,aAAb,GAA6BrC,KAA7B,CAAjB,KACA,KAAKC,OAAL,CAAaD,KAAb,GAAqBA,KAArB;EACN,KA5BM;EA8BPwB,IAAAA,SA9BO,uBA8BM;EACX,UAAMc,GAAG,GAAG,KAAKlB,UAAL,EAAZ;;EACA,WAAKZ,KAAL,CAAW,OAAX,EAAoB8B,GAApB;EACA,WAAK9B,KAAL,CAAW,QAAX,EAAqB8B,GAArB;EACD,KAlCM;EAoCPC,IAAAA,WApCO,yBAoCQ;EACb,WAAK/B,KAAL,CAAW,UAAX,EAAuB,KAAKY,UAAL,EAAvB;EACD,KAtCM;EAwCPT,IAAAA,SAxCO,uBAwCkC;EAAA,UAA9BI,WAA8B,uEAAlB,KAAKA,WAAa;EACvC,WAAKd,OAAL,GAAeuC,KAAK,CAAC,KAAKf,GAAN,EAAWV,WAAX,CAAL,CACZb,EADY,CACT,QADS,EACC,KAAKsB,SAAL,CAAeiB,IAAf,CAAoB,IAApB,CADD,EAEZvC,EAFY,CAET,UAFS,EAEG,KAAKqC,WAAL,CAAiBE,IAAjB,CAAsB,IAAtB,CAFH,CAAf;;EAGA,WAAKlB,YAAL;EACD,KA7CM;EA+CPV,IAAAA,YA/CO,0BA+CS;EACd,UAAI,KAAKZ,OAAT,EAAkB;EAChB,aAAKA,OAAL,CAAayC,OAAb;EACA,eAAO,KAAKzC,OAAZ;EACD;EACF;EApDM,GAlEY;EAyHrBH,EAAAA,KAAK,EAAE;EACL;EACAO,IAAAA,IAAI,EAAE,EAFD;EAGLL,IAAAA,KAAK,EAAE,EAHF;EAILmC,IAAAA,MAAM,EAAE;EACNQ,MAAAA,SAAS,EAAE,mBAAU3C,KAAV,EAAiB;EAC1B,eAAOA,KAAK,KAAK,OAAV,IAAqB,OAAOA,KAAP,KAAiB,SAA7C;EACD;EAHK,KAJH;EASL4C,IAAAA,OAAO,EAAEC,QATJ;EAULC,IAAAA,QAAQ,EAAED,QAVL;EAWLE,IAAAA,MAAM,EAAEF,QAXH;EAYLG,IAAAA,SAAS,EAAE;EACTC,MAAAA,IAAI,EAAEC,OADG;EAETC,MAAAA,QAAQ,EAAE,KAFD;EAGTC,MAAAA,OAAO,EAAEpB;EAHA,KAZN;EAkBL;EACAqB,IAAAA,eAAe,EAAEC,MAnBZ;EAoBLC,IAAAA,IAAI,EAAE;EACJN,MAAAA,IAAI,EAAEC,OADF;EAEJC,MAAAA,QAAQ,EAAE,KAFN;EAGJC,MAAAA,OAAO,EAAEpB;EAHL,KApBD;EAyBLwB,IAAAA,WAAW,EAAE5B,MAzBR;EA0BL6B,IAAAA,MAAM,EAAE7B,MA1BH;EA4BL;EACA8B,IAAAA,OAAO,EAAEJ,MA7BJ;EA8BLK,IAAAA,MAAM,EAAEd,QA9BH;EA+BLe,IAAAA,KAAK,EAAEf,QA/BF;EAgCLgB,IAAAA,OAAO,EAAE;EACPZ,MAAAA,IAAI,EAAEC,OADC;EAEPC,MAAAA,QAAQ,EAAE,KAFH;EAGPC,MAAAA,OAAO,EAAEpB;EAHF,KAhCJ;EAsCL;EACA8B,IAAAA,KAAK,EAAER,MAvCF;EAwCLS,IAAAA,kBAAkB,EAAET,MAxCf;EAyCLU,IAAAA,UAAU,EAAEC,KAzCP;EA0CLC,IAAAA,KAAK,EAAEC,MA1CF;EA2CLC,IAAAA,MAAM,EAAE;EACNnB,MAAAA,IAAI,EAAEC,OADA;EAENC,MAAAA,QAAQ,EAAE,KAFJ;EAGNC,MAAAA,OAAO,EAAEpB;EAHH,KA3CH;EAgDLqC,IAAAA,cAAc,EAAE;EACdpB,MAAAA,IAAI,EAAEC,OADQ;EAEdC,MAAAA,QAAQ,EAAE,KAFI;EAGdC,MAAAA,OAAO,EAAEpB;EAHK,KAhDX;EAqDLsC,IAAAA,kBAAkB,EAAE;EAClBrB,MAAAA,IAAI,EAAEC,OADY;EAElBC,MAAAA,QAAQ,EAAE,KAFQ;EAGlBC,MAAAA,OAAO,EAAEpB;EAHS,KArDf;EA0DLuC,IAAAA,GAAG,EAAE,CAACJ,MAAD,EAASK,IAAT,CA1DA;EA2DLC,IAAAA,GAAG,EAAE,CAACN,MAAD,EAASK,IAAT,CA3DA;EA6DL;EACAE,IAAAA,QAAQ,EAAE7B;EA9DL;EAzHc,CAAvB;;ECAA,IAAM8B,cAAc,GAAG;EACrBhF,EAAAA,IAAI,EAAE,OADe;EAGrB8C,EAAAA,IAHqB,gBAGfpB,EAHe,QAGO;EAAA,QAAVuD,OAAU,QAAjB5E,KAAiB;EAC1B,QAAI,CAAC4E,OAAL,EAAc;EAEdC,IAAAA,QAAQ,CAACxD,EAAD,EAAKuD,OAAL,CAAR;EACD,GAPoB;EASrBE,EAAAA,MATqB,kBASbzD,EATa,SASS;EAAA,QAAVuD,OAAU,SAAjB5E,KAAiB;;EAC5B,QAAI4E,OAAJ,EAAa;EACX,UAAIvD,EAAE,CAACpB,OAAP,EAAgB;EACdoB,QAAAA,EAAE,CAACpB,OAAH,CAAWkB,aAAX,CAAyByD,OAAzB;EACA,YAAIvD,EAAE,CAACrB,KAAH,KAAaqB,EAAE,CAACpB,OAAH,CAAWD,KAA5B,EAAmCqB,EAAE,CAACpB,OAAH,CAAW8E,SAAX;EACpC,OAHD,MAIKF,QAAQ,CAACxD,EAAD,EAAKuD,OAAL,CAAR;EACN,KAND,MAMO;EACLI,MAAAA,WAAW,CAAC3D,EAAD,CAAX;EACD;EACF,GAnBoB;EAqBrB4D,EAAAA,MArBqB,kBAqBb5D,EArBa,EAqBT;EACV2D,IAAAA,WAAW,CAAC3D,EAAD,CAAX;EACD;EAvBoB,CAAvB;;EA0BA,SAAS6D,SAAT,CAAoB7D,EAApB,EAAwB8D,SAAxB,EAAmCC,IAAnC,EAAyC;EACvC,MAAIC,CAAC,GAAGC,QAAQ,CAACC,WAAT,CAAqB,aAArB,CAAR;EACAF,EAAAA,CAAC,CAACG,eAAF,CAAkBL,SAAlB,EAA6B,IAA7B,EAAmC,IAAnC,EAAyCC,IAAzC;EACA/D,EAAAA,EAAE,CAACoE,aAAH,CAAiBJ,CAAjB;EACD;;EAED,SAASR,QAAT,CAAmBxD,EAAnB,EAAuBqE,IAAvB,EAA6B;EAC3BrE,EAAAA,EAAE,CAACpB,OAAH,GAAauC,KAAK,CAACnB,EAAD,EAAKqE,IAAL,CAAL,CACVxF,EADU,CACP,QADO,EACG;EAAA,WAAMgF,SAAS,CAAC7D,EAAD,EAAK,QAAL,EAAeA,EAAE,CAACpB,OAAlB,CAAf;EAAA,GADH,EAEVC,EAFU,CAEP,UAFO,EAEK;EAAA,WAAMgF,SAAS,CAAC7D,EAAD,EAAK,UAAL,EAAiBA,EAAE,CAACpB,OAApB,CAAf;EAAA,GAFL,CAAb;EAGD;;EAED,SAAS+E,WAAT,CAAsB3D,EAAtB,EAA0B;EACxB,MAAIA,EAAE,CAACpB,OAAP,EAAgB;EACdoB,IAAAA,EAAE,CAACpB,OAAH,CAAWyC,OAAX;EACA,WAAOrB,EAAE,CAACpB,OAAV;EACD;EACF;;;;;;;;;;;;;"}